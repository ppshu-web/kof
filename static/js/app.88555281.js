(function(){"use strict";var e={5163:function(e,s,o){var t=o(5130),a=o(6768);function n(e,s,o,t,n,r){const l=(0,a.g2)("NavBar"),c=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(l),((0,a.uX)(),(0,a.Wv)(c,{key:e.$router.fullPath}))],64)}o(5707);var r=o(4232);const l={class:"navbar navbar-expand-lg navbar-light bg-light"},c={class:"container"},u={class:"collapse navbar-collapse",id:"navbarNav"},i={class:"navbar-nav me-auto mb-2 mb-lg-0"},p={class:"nav-item"},d={class:"nav-item"},m={key:0,class:"navbar-nav"},f={class:"nav-item"},v={class:"nav-item"},b={key:1,class:"navbar-nav"},k={class:"nav-item"},_={class:"nav-item"};function g(e,s,o,t,n,g){const w=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("nav",l,[(0,a.Lk)("div",c,[(0,a.bF)(w,{class:"navbar-brand",to:{name:"home"}},{default:(0,a.k6)((()=>s[1]||(s[1]=[(0,a.eW)("Myspace")]))),_:1}),s[6]||(s[6]=(0,a.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,a.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,a.Lk)("div",u,[(0,a.Lk)("ul",i,[(0,a.Lk)("li",p,[(0,a.bF)(w,{class:"nav-link",to:{name:"home"}},{default:(0,a.k6)((()=>s[2]||(s[2]=[(0,a.eW)("首页")]))),_:1})]),(0,a.Lk)("li",d,[(0,a.bF)(w,{class:"nav-link",to:{name:"userlist"}},{default:(0,a.k6)((()=>s[3]||(s[3]=[(0,a.eW)("好友列表")]))),_:1})])]),e.$store.state.user.is_login?((0,a.uX)(),(0,a.CE)("ul",b,[(0,a.Lk)("li",k,[(0,a.bF)(w,{class:"nav-link",to:{name:"userprofile",params:{userId:e.$store.state.user.id}}},{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(e.$store.state.user.username),1)])),_:1},8,["to"])]),(0,a.Lk)("li",_,[(0,a.Lk)("a",{class:"nav-link",style:{cursor:"pointer"},onClick:s[0]||(s[0]=(...e)=>t.logout&&t.logout(...e))},"退出")])])):((0,a.uX)(),(0,a.CE)("ul",m,[(0,a.Lk)("li",f,[(0,a.bF)(w,{class:"nav-link",to:{name:"login"}},{default:(0,a.k6)((()=>s[4]||(s[4]=[(0,a.eW)("登录")]))),_:1})]),(0,a.Lk)("li",v,[(0,a.bF)(w,{class:"nav-link",to:{name:"register"}},{default:(0,a.k6)((()=>s[5]||(s[5]=[(0,a.eW)("注册")]))),_:1})])]))])])])}var w=o(782),h={name:"NavBar",setup(){const e=(0,w.Pj)(),s=()=>{e.commit("logout")};return{logout:s}}},y=o(1241);const L=(0,y.A)(h,[["render",g]]);var C=L,P={name:"App",components:{NavBar:C}};const j=(0,y.A)(P,[["render",n]]);var E=j,A=o(5290),x=o.n(A),B=o(3913);const O={state:{id:"",username:"",photo:"",followerCount:0,access:"",refresh:"",is_login:!1},getters:{},mutations:{updateUser(e,s){e.id=s.id,e.username=s.username,e.photo=s.photo,e.followerCount=s.followerCount,e.access=s.access,e.refresh=s.refresh,e.is_login=s.is_login},updateAccess(e,s){e.access=s},logout(e){e.id="",e.username="",e.photo="",e.followerCount=0,e.access="",e.refresh="",e.is_login=!1}},actions:{login(e,s){x().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/",type:"POST",data:{username:s.username,password:s.password},success(o){const{access:t,refresh:a}=o,n=(0,B.s)(t);setInterval((()=>{x().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/refresh/",type:"POST",data:{refresh:a},success(s){e.commit("updateAccess",s.access)}})}),27e4),x().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:n.user_id},headers:{Authorization:"Bearer "+t},success(o){e.commit("updateUser",{...o,access:t,refresh:a,is_login:!0}),s.success()}})},error(){s.error()}})}},modules:{}};var U=O,X=(0,w.y$)({state:{},getters:{},mutations:{},actions:{},modules:{user:U}}),W=o(1387);function I(e,s,o,t,n,r){const l=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(l,null,{default:(0,a.k6)((()=>s[0]||(s[0]=[(0,a.eW)(" 首页 ")]))),_:1})}const F={class:"home"},T={class:"container"},S={class:"card"},K={class:"card-body"};function V(e,s,o,t,n,r){return(0,a.uX)(),(0,a.CE)("div",F,[(0,a.Lk)("div",T,[(0,a.Lk)("div",S,[(0,a.Lk)("div",K,[(0,a.RG)(e.$slots,"default",{},void 0,!0)])])])])}var R={name:"ContentBase"};const $=(0,y.A)(R,[["render",V],["__scopeId","data-v-32bf9f79"]]);var z=$,N={name:"HomeView",components:{ContentBase:z}};const D=(0,y.A)(N,[["render",I]]);var J=D;const G=["onClick"],q={class:"card-body"},M={class:"row"},Q={class:"col-1 img-field"},H=["src"],Y={class:"col-11"},Z={class:"username"},ee={class:"follow-count"};function se(e,s,o,t,n,l){const c=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(c,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.users,(e=>((0,a.uX)(),(0,a.CE)("div",{class:"card",key:e.id,onClick:s=>t.open_user_profile(e.id)},[(0,a.Lk)("div",q,[(0,a.Lk)("div",M,[(0,a.Lk)("div",Q,[(0,a.Lk)("img",{class:"img-fluid",src:e.photo,alt:""},null,8,H)]),(0,a.Lk)("div",Y,[(0,a.Lk)("div",Z,(0,r.v_)(e.username),1),(0,a.Lk)("div",ee,(0,r.v_)(e.followerCount),1)])])])],8,G)))),128))])),_:1})}o(4114);var oe=o(144),te={name:"UserListView",components:{ContentBase:z},setup(){const e=(0,w.Pj)();let s=(0,oe.KR)([]);x().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/userlist/",type:"GET",success(e){s.value=e}});const o=s=>{e.state.user.is_login?ps.push({name:"userprofile",params:{userId:s}}):ps.push({name:"login"})};return{users:s,open_user_profile:o}}};const ae=(0,y.A)(te,[["render",se],["__scopeId","data-v-8ed6150e"]]);var ne=ae;const re={class:"row"},le={class:"col-3"},ce={class:"col-9"};function ue(e,s,o,t,n,r){const l=(0,a.g2)("UserProfileInfo"),c=(0,a.g2)("UserProfileWrite"),u=(0,a.g2)("UserProfilePosts"),i=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(i,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",re,[(0,a.Lk)("div",le,[(0,a.bF)(l,{onFollow:t.follow,onUnfollow:t.unfollow,user:t.user},null,8,["onFollow","onUnfollow","user"]),t.is_me?((0,a.uX)(),(0,a.Wv)(c,{key:0,onPost_a_post:t.post_a_post},null,8,["onPost_a_post"])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ce,[(0,a.bF)(u,{user:t.user,posts:t.posts,onDelete_a_post:t.delete_a_post},null,8,["user","posts","onDelete_a_post"])])])])),_:1})}const ie={class:"card"},pe={class:"card-body"},de={class:"row"},me={class:"col-3 img-field"},fe=["src"],ve={class:"col-9"},be={class:"username"},ke={class:"fans"};function _e(e,s,o,t,n,l){return(0,a.uX)(),(0,a.CE)("div",ie,[(0,a.Lk)("div",pe,[(0,a.Lk)("div",de,[(0,a.Lk)("div",me,[(0,a.Lk)("img",{class:"img-fluid",src:o.user.photo,alt:""},null,8,fe)]),(0,a.Lk)("div",ve,[(0,a.Lk)("div",be,(0,r.v_)(o.user.username),1),(0,a.Lk)("div",ke,"Followers："+(0,r.v_)(o.user.followerCount),1),o.user.is_followed?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:s[0]||(s[0]=(...e)=>t.follow&&t.follow(...e)),type:"button",class:"btn btn-secondary btn-sm"},"+关注")),o.user.is_followed?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:s[1]||(s[1]=(...e)=>t.unfollow&&t.unfollow(...e)),type:"button",class:"btn btn-secondary btn-sm"},"取消关注")):(0,a.Q3)("",!0)])])])])}var ge={name:"UserProfileInfo",props:{user:{type:Object,required:!0}},setup(e,s){const o=(0,w.Pj)(),t=()=>{x().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+o.state.user.access},success(e){"success"===e.result&&s.emit("follow")}})},a=()=>{x().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+o.state.user.access},success(e){"success"===e.result&&s.emit("unfollow")}})};return{follow:t,unfollow:a}}};const we=(0,y.A)(ge,[["render",_e],["__scopeId","data-v-1d8895d0"]]);var he=we;const ye={class:"card"},Le={class:"card-body"},Ce={class:"card single-post"},Pe={class:"card-body"},je=["onClick"];function Ee(e,s,o,t,n,l){return(0,a.uX)(),(0,a.CE)("div",ye,[(0,a.Lk)("div",Le,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.posts.posts,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id},[(0,a.Lk)("div",Ce,[(0,a.Lk)("div",Pe,[(0,a.eW)((0,r.v_)(e.content)+" ",1),t.is_me?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:s=>t.delete_a_post(e.id),type:"button",class:"btn btn-danger btn-sm"},"Delete",8,je)):(0,a.Q3)("",!0)])])])))),128))])])}var Ae={name:"UserProfilePosts",props:{posts:{type:Object,required:!0},user:{type:Object,required:!0}},setup(e,s){const o=(0,w.Pj)();let t=(0,a.EW)((()=>o.state.user.id===e.user.id));const n=e=>{x().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"DELETE",data:{post_id:e},headers:{Authorization:"Bearer "+o.state.user.access},success(o){"success"===o.result&&s.emit("delete_a_post",e)}})};return{is_me:t,delete_a_post:n}}};const xe=(0,y.A)(Ae,[["render",Ee],["__scopeId","data-v-898bf18e"]]);var Be=xe;const Oe={class:"card edit-field"},Ue={class:"card-body"};function Xe(e,s,o,n,r,l){return(0,a.uX)(),(0,a.CE)("div",Oe,[(0,a.Lk)("div",Ue,[s[2]||(s[2]=(0,a.Lk)("label",{for:"edit-post",class:"form-label"},"Edit your post here",-1)),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.content=e),class:"form-control",id:"exampleFormControlTextarea1",rows:"3"},null,512),[[t.Jo,n.content]]),(0,a.Lk)("button",{onClick:s[1]||(s[1]=(...e)=>n.post_a_post&&n.post_a_post(...e)),type:"button",class:"btn btn-primary btn-sm"},"POST")])])}var We={name:"UserProfileWrite",setup(e,s){const o=(0,w.Pj)();let t=(0,oe.KR)("");const a=()=>{x().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"POST",data:{content:t.value},headers:{Authorization:"Bearer "+o.state.user.access},success(e){"success"===e.result&&(s.emit("post_a_post",t.value),t.value="")}})};return{content:t,post_a_post:a}}};const Ie=(0,y.A)(We,[["render",Xe],["__scopeId","data-v-25de8d5d"]]);var Fe=Ie,Te={name:"UserProfileView",components:{ContentBase:z,UserProfileInfo:he,UserProfilePosts:Be,UserProfileWrite:Fe},setup(){const e=(0,w.Pj)(),s=(0,W.lq)(),o=parseInt(s.params.userId),t=(0,oe.Kh)({}),n=(0,oe.Kh)({});x().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:o},headers:{Authorization:"Bearer "+e.state.user.access},success(e){t.id=e.id,t.username=e.username,t.photo=e.photo,t.followerCount=e.followerCount,t.is_followed=e.is_followed}}),x().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"GET",data:{user_id:o},headers:{Authorization:"Bearer "+e.state.user.access},success(e){n.count=e.length,n.posts=e}});const r=()=>{t.is_followed||(t.is_followed=!0,t.followerCount++)},l=()=>{t.is_followed&&(t.is_followed=!1,t.followerCount--)},c=e=>{n.count++,n.posts.unshift({id:n.count,userId:1,content:e})},u=e=>{n.posts=n.posts.filter((s=>s.id!==e)),n.count=n.posts.length},i=(0,a.EW)((()=>o===e.state.user.id));return{user:t,follow:r,unfollow:l,posts:n,post_a_post:c,delete_a_post:u,is_me:i}}};const Se=(0,y.A)(Te,[["render",ue]]);var Ke=Se;const Ve={class:"row justify-content-md-center"},Re={class:"col-3"},$e={class:"mb-3"},ze={class:"mb-3"},Ne={class:"error-message"};function De(e,s,o,n,l,c){const u=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(u,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",Ve,[(0,a.Lk)("div",Re,[(0,a.Lk)("form",{onSubmit:s[2]||(s[2]=(0,t.D$)(((...e)=>n.login&&n.login(...e)),["prevent"]))},[(0,a.Lk)("div",$e,[s[3]||(s[3]=(0,a.Lk)("label",{for:"username",class:"form-label"},"Username",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e),type:"text",class:"form-control",id:"username"},null,512),[[t.Jo,n.username]])]),(0,a.Lk)("div",ze,[s[4]||(s[4]=(0,a.Lk)("label",{for:"password",class:"form-label"},"Password",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),type:"password",class:"form-control",id:"password"},null,512),[[t.Jo,n.password]])]),(0,a.Lk)("div",Ne,(0,r.v_)(n.error_message),1),s[5]||(s[5]=(0,a.Lk)("button",{type:"submit",class:"btn btn-primary"},"Submit",-1))],32)])])])),_:1})}var Je={name:"LoginView",components:{ContentBase:z},setup(){const e=(0,w.Pj)();let s=(0,oe.KR)(""),o=(0,oe.KR)(""),t=(0,oe.KR)("");const a=()=>{t.value="",e.dispatch("login",{username:s.value,password:o.value,success(){ps.push({name:"userlist"})},error(){t.value="wrong username or password"}})};return{username:s,password:o,error_message:t,login:a}}};const Ge=(0,y.A)(Je,[["render",De],["__scopeId","data-v-aadb0fdc"]]);var qe=Ge;const Me={class:"row justify-content-md-center"},Qe={class:"col-3"},He={class:"mb-3"},Ye={class:"mb-3"},Ze={class:"mb-3"},es={class:"error-message"};function ss(e,s,o,n,l,c){const u=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(u,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",Me,[(0,a.Lk)("div",Qe,[(0,a.Lk)("form",{onSubmit:s[3]||(s[3]=(0,t.D$)(((...e)=>n.register&&n.register(...e)),["prevent"]))},[(0,a.Lk)("div",He,[s[4]||(s[4]=(0,a.Lk)("label",{for:"username",class:"form-label"},"Username",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e),type:"text",class:"form-control",id:"username"},null,512),[[t.Jo,n.username]])]),(0,a.Lk)("div",Ye,[s[5]||(s[5]=(0,a.Lk)("label",{for:"password",class:"form-label"},"Password",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),type:"password",class:"form-control",id:"password"},null,512),[[t.Jo,n.password]])]),(0,a.Lk)("div",Ze,[s[6]||(s[6]=(0,a.Lk)("label",{for:"password_confirm",class:"form-label"},"Password Confirm ",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>n.password_confirm=e),type:"password",class:"form-control",id:"password_confirm"},null,512),[[t.Jo,n.password_confirm]])]),(0,a.Lk)("div",es,(0,r.v_)(n.error_message),1),s[7]||(s[7]=(0,a.Lk)("button",{type:"submit",class:"btn btn-primary"},"Submit",-1))],32)])])])),_:1})}var os={name:"RegisterView",components:{ContentBase:z},setup(){const e=(0,w.Pj)();let s=(0,oe.KR)(""),o=(0,oe.KR)(""),t=(0,oe.KR)(""),a=(0,oe.KR)("");const n=()=>{a.value="",x().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/user/",type:"POST",data:{username:s.value,password:o.value,password_confirm:t.value},success(t){"success"===t.result?e.dispatch("login",{username:s.value,password:o.value,success(){ps.push({name:"userlist"})},error(){a.value="something wrong, please try again later"}}):a.value=t.result}})};return{username:s,password:o,password_confirm:t,error_message:a,register:n}}};const ts=(0,y.A)(os,[["render",ss],["__scopeId","data-v-46de7d36"]]);var as=ts;function ns(e,s,o,t,n,r){const l=(0,a.g2)("ContentBase");return(0,a.uX)(),(0,a.Wv)(l,null,{default:(0,a.k6)((()=>s[0]||(s[0]=[(0,a.eW)(" 404 ")]))),_:1})}var rs={name:"NotFoundView",components:{ContentBase:z}};const ls=(0,y.A)(rs,[["render",ns]]);var cs=ls;const us=[{path:"/myspace/",name:"home",component:J},{path:"/myspace/userlist/",name:"userlist",component:ne},{path:"/myspace/userprofile/:userId/",name:"userprofile",component:Ke},{path:"/myspace/login/",name:"login",component:qe},{path:"/myspace/register/",name:"register",component:as},{path:"/myspace/404/",name:"404",component:cs},{path:"/:catchAll(.*)",redirect:"/myspace/404/"}],is=(0,W.aE)({history:(0,W.LA)(),routes:us});var ps=is;(0,t.Ef)(E).use(ps).use(X).mount("#app")}},s={};function o(t){var a=s[t];if(void 0!==a)return a.exports;var n=s[t]={exports:{}};return e[t].call(n.exports,n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(s,t,a,n){if(!t){var r=1/0;for(i=0;i<e.length;i++){t=e[i][0],a=e[i][1],n=e[i][2];for(var l=!0,c=0;c<t.length;c++)(!1&n||r>=n)&&Object.keys(o.O).every((function(e){return o.O[e](t[c])}))?t.splice(c--,1):(l=!1,n<r&&(r=n));if(l){e.splice(i--,1);var u=a();void 0!==u&&(s=u)}}return s}n=n||0;for(var i=e.length;i>0&&e[i-1][2]>n;i--)e[i]=e[i-1];e[i]=[t,a,n]}}(),function(){o.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(s,{a:s}),s}}(),function(){o.d=function(e,s){for(var t in s)o.o(s,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(s){return 0===e[s]};var s=function(s,t){var a,n,r=t[0],l=t[1],c=t[2],u=0;if(r.some((function(s){return 0!==e[s]}))){for(a in l)o.o(l,a)&&(o.m[a]=l[a]);if(c)var i=c(o)}for(s&&s(t);u<r.length;u++)n=r[u],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(i)},t=self["webpackChunkmckenna"]=self["webpackChunkmckenna"]||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))}();var t=o.O(void 0,[504],(function(){return o(5163)}));t=o.O(t)})();
//# sourceMappingURL=app.88555281.js.map